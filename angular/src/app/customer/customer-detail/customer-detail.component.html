<div class="container-fluid">
  <div class="row">
    <div class="col-12">
      <!-- Breadcrumb -->
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item">
            <a [routerLink]="['/customers']">{{ '::Menu:Customers' | abpLocalization }}</a>
          </li>
          <li class="breadcrumb-item active" aria-current="page">
            {{ customer?.name || 'Customer Details' }}
          </li>
        </ol>
      </nav>

      <!-- Loading Spinner -->
      <div *ngIf="loading" class="text-center py-5">
        <div class="spinner-border" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
      </div>

      <!-- Customer Details Card -->
      <div *ngIf="!loading && customer" class="card mb-4">
        <div class="card-header d-flex justify-content-between align-items-center">
          <h5 class="card-title mb-0">{{ '::CustomerDetails' | abpLocalization }}</h5>
          <div>
            <button type="button" class="btn btn-primary btn-sm me-2" (click)="editCustomer()">
              <i class="fa fa-edit"></i> {{ '::Edit' | abpLocalization }}
            </button>
            <button type="button" class="btn btn-secondary btn-sm" (click)="goBack()">
              <i class="fa fa-arrow-left"></i> {{ '::Back' | abpLocalization }}
            </button>
          </div>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-6">
              <dl class="row">
                <dt class="col-sm-4">{{ '::Name' | abpLocalization }}:</dt>
                <dd class="col-sm-8">{{ customer.name }}</dd>

                <dt class="col-sm-4">{{ '::Email' | abpLocalization }}:</dt>
                <dd class="col-sm-8">
                  <a [href]="'mailto:' + customer.email">{{ customer.email }}</a>
                </dd>

                <dt class="col-sm-4" *ngIf="customer.phone">{{ '::Phone' | abpLocalization }}:</dt>
                <dd class="col-sm-8" *ngIf="customer.phone">{{ customer.phone }}</dd>
              </dl>
            </div>
            <div class="col-md-6">
              <dl class="row">
                <dt class="col-sm-4" *ngIf="customer.billingAddress">{{ '::BillingAddress' | abpLocalization }}:</dt>
                <dd class="col-sm-8" *ngIf="customer.billingAddress">
                  <pre class="mb-0" style="white-space: pre-wrap;">{{ customer.billingAddress }}</pre>
                </dd>

                <dt class="col-sm-4">{{ '::CreatedAt' | abpLocalization }}:</dt>
                <dd class="col-sm-8">{{ customer.creationTime | date: 'short' }}</dd>

                <dt class="col-sm-4" *ngIf="customer.lastModificationTime">{{ '::LastModified' | abpLocalization }}:</dt>
                <dd class="col-sm-8" *ngIf="customer.lastModificationTime">
                  {{ customer.lastModificationTime | date: 'short' }}
                </dd>
              </dl>
            </div>
          </div>
        </div>
      </div>

      <!-- Customer Invoices Card -->
      <div *ngIf="!loading && customer" class="card">
        <div class="card-header d-flex justify-content-between align-items-center">
          <h5 class="card-title mb-0">{{ '::Invoices' | abpLocalization }}</h5>
          <span class="badge bg-primary">{{ invoices.length }} {{ '::Total' | abpLocalization }}</span>
        </div>
        <div class="card-body">
          <!-- Empty State -->
          <div *ngIf="invoices.length === 0" class="text-center py-5 text-muted">
            <i class="fa fa-file-invoice fa-3x mb-3"></i>
            <p>{{ '::NoInvoicesFound' | abpLocalization }}</p>
          </div>

          <!-- Invoices Table -->
          <div *ngIf="invoices.length > 0" class="table-responsive">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th>{{ '::InvoiceNumber' | abpLocalization }}</th>
                  <th>{{ '::InvoiceDate' | abpLocalization }}</th>
                  <th>{{ '::DueDate' | abpLocalization }}</th>
                  <th>{{ '::Status' | abpLocalization }}</th>
                  <th class="text-end">{{ '::GrandTotal' | abpLocalization }}</th>
                  <th>{{ '::Actions' | abpLocalization }}</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let invoice of invoices">
                  <td>
                    <a [routerLink]="['/invoices', invoice.id]" class="text-decoration-none">
                      {{ invoice.invoiceNumber }}
                    </a>
                  </td>
                  <td>{{ invoice.invoiceDate | date: 'shortDate' }}</td>
                  <td>{{ invoice.dueDate ? (invoice.dueDate | date: 'shortDate') : '-' }}</td>
                  <td>
                    <span [ngClass]="getStatusBadgeClass(invoice.status)">
                      {{ getStatusName(invoice.status) }}
                    </span>
                  </td>
                  <td class="text-end">{{ invoice.grandTotal | currency }}</td>
                  <td>
                    <button
                      type="button"
                      class="btn btn-sm btn-outline-primary"
                      (click)="viewInvoice(invoice.id)"
                    >
                      <i class="fa fa-eye"></i> {{ '::View' | abpLocalization }}
                    </button>
                  </td>
                </tr>
              </tbody>
              <tfoot *ngIf="invoices.length > 0">
                <tr class="table-secondary fw-bold">
                  <td colspan="4" class="text-end">{{ '::TotalAmount' | abpLocalization }}:</td>
                  <td class="text-end">
                    {{ getTotalInvoiceAmount() | currency }}
                  </td>
                  <td></td>
                </tr>
              </tfoot>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
